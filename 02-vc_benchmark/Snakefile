import numpy as np

# path to snakemake-slurm config
# /home/hblee/snakemake_slurm/testv8/profile_cpu
# snakemake --profile=/path/to/profile
#
# tree simulation setting
sample_size = np.array([2000, 5000, 10000, 20000, 50000, 100000])
ts_pattern = "tree_sequences/ts_n{num_individuals}.ts"
tree_sequences = expand(ts_pattern,
			 			num_individuals = sample_size)

# inferred tree
its_pattern = "inferred_tree_sequences/ts_n{num_individuals}.ts"
inferred_tree_sequences = expand(its_pattern,
								 num_individuals = sample_size)

# estimation testing
its = np.arange(20)
vc_pattern = "variance_components/vc_n{num_individuals}_i{it}.npy"
vcs = expand(vc_pattern, num_individuals=sample_size, it=its)

# ---
rule all:
	input:
		vcs

# ---
rule ts:
	output:
		ts_save_path = ts_pattern	
	params:
		seq_length = 1e6,
		num_individuals = "{num_individuals}",		
	script:
		"00-sim_ts.py"

# ---
rule its:
	output:
		ts_save_path = its_pattern
	input:
		ts_path = ts_pattern
	script:
		"01-infer.py"
		
# ---
rule vc:
	input:
		ts_path = ts_pattern,
		its_path = its_pattern
	output:
		save_path = vc_pattern
	params:
		num_individuals = "{num_individuals}"
	script:
		"02-estimation.py"
